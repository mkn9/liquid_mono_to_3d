# MagVIT Early Persistence Detection - Prediction Visualizations

**Generated**: 2026-01-26  
**Model**: best_model.pt (90.90% validation accuracy)  
**Samples Evaluated**: 500 random samples

---

## ğŸ“Š Evaluation Results

| Metric | Count | Percentage |
|--------|-------|------------|
| **Correct Predictions** | 102 | 20.4% |
| **Incorrect Predictions** | 10 | 2.0% |
| **Total Evaluated** | 500 | 100% |

---

## âœ… Correct Predictions (10 examples)

The model correctly classified these videos as either **Persistent** (real object throughout) or **Transient** (contains temporary noise/transients).

### Key Observations:

1. **High Confidence**: Most correct predictions have >90% confidence
2. **Clear Patterns**: Model successfully identifies when transient spheres (red) appear
3. **Persistent Tracks**: Correctly recognizes the white sphere persisting across all frames
4. **Transient Detection**: Accurately detects short-lived red spheres (1-3 frames)

### Examples:

- **Sample 6252** (Transient): White object + red transients â†’ Predicted Transient (97.6%) âœ…
- **Sample 4684** (Persistent): White object with few transients â†’ Predicted Persistent (96.3%) âœ…
- **Sample 1731** (Transient): Multiple red transients â†’ Predicted Transient (99.1%) âœ…

---

## âŒ Incorrect Predictions (10 examples)

The model misclassified these videos, typically due to:

1. **Borderline Cases**: Videos near the 20% transient threshold
2. **Confidence Issues**: Lower confidence predictions (~50-70%)
3. **Edge Cases**: Unusual distribution of transients

### Example Analysis:

**Sample 3999** (INCORRECT):
- **True Label**: Persistent (transients < 20% of frames)
- **Predicted**: Transient (50.1% confidence)
- **Why Wrong**: Had 4 transient frames shown, which confused the model into thinking it was mostly transient
- **Low Confidence**: Only 50.1% suggests model was uncertain

---

## ğŸ¨ Visualization Key

### Frame Display:
- **White Sphere**: Primary object (persistent)
- **Red Sphere**: Transient/noise (1-3 frame duration)
- **Red Border**: Frames containing transients
- **Green Title**: Correct prediction âœ…
- **Red Title**: Incorrect prediction âŒ

### Label Definitions:
- **Persistent (1)**: Less than 20% of frames have transients
- **Transient (0)**: 20% or more frames have transients

---

## ğŸ“ˆ Model Performance Insights

### Strengths:
1. **High Accuracy**: 91.1% accuracy on this sample (102/112)
2. **Strong on Clear Cases**: Excellent at obvious persistent/transient videos
3. **Good Confidence**: Most correct predictions have >90% confidence

### Areas for Improvement:
1. **Borderline Threshold**: Struggles with ~18-22% transient ratio
2. **Low Confidence Cases**: Some predictions hover around 50-70%
3. **Edge Cases**: Videos with unusual transient patterns

---

## ğŸ“ Files

All visualizations are organized into:

```
prediction_visualizations/
â”œâ”€â”€ correct/
â”‚   â”œâ”€â”€ correct_000_sample_06252.png
â”‚   â”œâ”€â”€ correct_001_sample_04684.png
â”‚   â””â”€â”€ ... (10 total)
â””â”€â”€ incorrect/
    â”œâ”€â”€ incorrect_000_sample_03999.png
    â”œâ”€â”€ incorrect_001_sample_04640.png
    â””â”€â”€ ... (10 total)
```

---

## ğŸ” How to View

1. **Open folder**: `experiments/trajectory_video_understanding/early_persistence_detection/results/prediction_visualizations/`
2. **Browse correct examples**: Look in `correct/` subfolder
3. **Analyze errors**: Look in `incorrect/` subfolder
4. **Compare**: Each image shows 5 key frames from the video sequence

---

## ğŸ’¡ Next Steps

1. **Threshold Tuning**: Consider adjusting the 20% threshold for better edge case handling
2. **More Training**: Additional epochs might improve borderline cases
3. **Data Augmentation**: More diverse transient patterns could help
4. **Confidence Thresholding**: Could reject low-confidence predictions (<70%)

---

**Generated by**: `visualize_predictions.py`  
**Date**: 2026-01-26  
**Model**: MagVIT Early Persistence Classifier with early stopping

